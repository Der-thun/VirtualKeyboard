(()=>{"use strict";const e=new class{elements={main:null,keysContainer:null,title:null,textarea:null,description:null,language:null,keys:[]};events={oninput:null,onclose:null};properties={value:"",capsLock:!1,shift:!1,shiftReal:!1,alt:!1,ctrl:!1,currentLanguage:"ru",dictRu:["ё","1","2","3","4","5","6","7","8","9","0","-","=","Backspace","Tab","й","ц","у","к","е","н","г","ш","щ","з","х","ъ","\\","Del","CapsLock","ф","ы","в","а","п","р","о","л","д","ж","э","Enter","ShiftL","я","ч","с","м","и","т","ь","б","ю",".","▲","ShiftR","CtrlL","Win","AltL","Space","AltR","◄","▼","►","CtrlR"],dictRuShiftFirstLine:{0:"Ё",1:"!",2:'"',3:"№",4:";",5:"%",6:":",7:"?",8:"*",9:"(",10:")",11:"_",12:"+",27:"/",52:","},dictEn:["`","1","2","3","4","5","6","7","8","9","0","-","=","Backspace","Tab","q","w","e","r","t","y","u","i","o","p","[","]","\\","Del","CapsLock","a","s","d","f","g","h","j","k","l",";","'","Enter","Shift","z","x","c","v","b","n","m",",",".","/","▲","Shift","Ctrl","Win","Alt","Space","Alt","◄","▼","►","Ctrl"],dictEnShiftFirstLine:{0:"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",10:")",11:"_",12:"+",25:"{",26:"}",27:"/",39:":",40:'"',50:"<",51:">",52:"?"},unToggledKeys:["backspace","tab","del","capslock","enter","shift","ctrl","win","alt","space"],whichKeyRU:{220:"ё",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",48:"0",187:"-",219:"=",81:"й",87:"ц",69:"у",82:"к",84:"е",89:"н",85:"г",73:"ш",79:"щ",80:"з",221:"х",186:"ъ",191:"\\",65:"ф",83:"ы",68:"в",70:"а",71:"п",72:"р",74:"о",75:"л",76:"д",192:"ж",222:"э",90:"я",88:"ч",67:"с",86:"м",66:"и",78:"т",77:"ь",188:"б",190:"ю",189:".",38:"▲",37:"◄",40:"▼",39:"►"},whichKeyEN:{220:"`",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",48:"0",187:"-",219:"=",81:"q",87:"w",69:"e",82:"r",84:"t",89:"y",85:"u",73:"i",79:"o",80:"p",221:"[",186:"]",191:"\\",65:"a",83:"s",68:"d",70:"f",71:"g",72:"h",74:"j",75:"k",76:"l",192:";",222:"'",90:"z",88:"x",67:"c",86:"v",66:"b",78:"n",77:"m",188:",",190:".",189:"/",38:"▲",37:"◄",40:"▼",39:"►"},codeKey:{Backspace:"Backspace",Tab:"Tab",Delete:"Del",CapsLock:"CapsLock",Enter:"Enter",ShiftLeft:"Shift",ArrowUp:"Up",ShiftRight:"Shift",ControlLeft:"Ctrl",MetaLeft:"Win",AltLeft:"Alt",Space:"Space",AltRight:"Alt",ArrowLeft:"Left",ArrowDown:"Down",ControlRight:"Ctrl"}};init(){this.elements.main=document.createElement("div"),this.elements.title=document.createElement("h1"),this.elements.textarea=document.createElement("textarea"),this.elements.keysContainer=document.createElement("div"),this.elements.description=document.createElement("p"),this.elements.language=document.createElement("p"),this.elements.main.classList.add("wrapper"),this.elements.title.classList.add("title"),this.elements.title.innerText="RSS Virtual Keyboard",this.elements.textarea.classList.add("input"),this.elements.textarea.autofocus=!0,this.elements.textarea.addEventListener("blur",(()=>{this.elements.textarea.focus()})),this.elements.keysContainer.classList.add("keyboard"),this.elements.keysContainer.appendChild(this._createKeys()),this.elements.keys=this.elements.keysContainer.querySelectorAll(".key"),this.elements.description.classList.add("description"),this.elements.description.innerText="Клавиатура создана в операционной системе Windows",this.elements.language.classList.add("language"),this.elements.language.innerText="Для переключения языка комбинация: левыe ctrl + alt",this.elements.main.appendChild(this.elements.title),this.elements.main.appendChild(this.elements.textarea),this.elements.main.appendChild(this.elements.keysContainer),this.elements.main.appendChild(this.elements.description),this.elements.main.appendChild(this.elements.language),document.body.appendChild(this.elements.main),this._keyPress()}_createKeys(){const e=document.createDocumentFragment();return this.properties.dictRu.forEach((e=>{const t=document.createElement("button");switch(t.setAttribute("type","button"),t.classList.add("key"),t.textContent=e,e){case"Backspace":t.classList.add("back"),t.addEventListener("click",(()=>{this._backspaceKeyPress()})),this.properties.shift&&this._shift();break;case"Tab":t.classList.add("m"),t.addEventListener("click",(()=>{this._tabKeyPress()})),this.properties.shift&&this._shift();break;case"CapsLock":t.classList.add("xl","caps-acvivalible","caps"),t.addEventListener("click",(()=>{this._toggleCaps(),t.classList.toggle("caps-active")}));break;case"Enter":t.classList.add("xxl"),t.addEventListener("click",(()=>{this._enterKeyPress()})),this.properties.shift&&this._shift();break;case"ShiftL":t.classList.add("xl","shiftleft"),t.textContent="Shift",t.addEventListener("click",(()=>{this._shift()}));break;case"ShiftR":t.classList.add("xl","shiftright"),t.textContent="Shift",t.addEventListener("click",(()=>{this._shift()}));break;case"CtrlL":t.classList.add("l","ctrlleft"),t.textContent="Ctrl",t.addEventListener("click",(()=>{this._ctrlKeyPress(),this._changeLanguage()}));break;case"CtrlR":t.classList.add("l","ctrlright"),t.textContent="Ctrl",t.addEventListener("click",(()=>{this._ctrlKeyPress()}));break;case"Win":t.classList.add("l");break;case"AltL":t.classList.add("l","altleft"),t.textContent="Alt",t.addEventListener("click",(()=>{this._altKeyPress(),this._changeLanguage()}));break;case"AltR":t.classList.add("l","altright"),t.textContent="Alt",t.addEventListener("click",(()=>{this._altKeyPress()}));break;case"Space":t.classList.add("space"),t.addEventListener("click",(()=>{this._spaceKeyPress()})),this.properties.shift&&this._shift();break;case"Del":t.addEventListener("click",(()=>{this._delKeyPress()})),this.properties.shift&&this._shift();break;default:t.addEventListener("click",(e=>{this._defaultKeyPress(e),this.properties.shift&&this._shift()}))}this.elements.keysContainer.appendChild(t)})),e}_defaultKeyPress(e){let t=document.querySelector(".input"),s=t.selectionStart,i=t.selectionEnd,r=this.properties.value,a="ru"===this.properties.currentLanguage?this.properties.whichKeyRU:this.properties.whichKeyEN,l=e.target.classList.contains("key")?e.target.textContent:this.properties.capsLock?a[e.which].toUpperCase():a[e.which].toLowerCase();r.length+1!==s?this.properties.value=r.slice(0,s)+l+r.slice(i):this.properties.value+=l,t.value=this.properties.value,t.setSelectionRange(s+1,s+1)}_backspaceKeyPress(){let e=document.querySelector(".input"),t=e.selectionStart,s=e.selectionEnd,i=this.properties.value;t===s?(i.length===t?this.properties.value=i.slice(0,i.length-1):this.properties.value=i.slice(0,t-1)+i.slice(s),e.value=this.properties.value,e.setSelectionRange(t-1,t-1)):(this.properties.value=i.slice(0,t)+i.slice(s),e.value=this.properties.value,e.setSelectionRange(t,t))}_delKeyPress(){let e=document.querySelector(".input"),t=e.selectionStart,s=e.selectionEnd,i=this.properties.value;t===s?(this.properties.value=0===t?i.slice(1):i.slice(0,t)+i.slice(s+1),e.value=this.properties.value,e.setSelectionRange(t,t)):(this.properties.value=i.slice(0,t)+i.slice(s),e.value=this.properties.value,e.setSelectionRange(t,t))}_enterKeyPress(){let e=document.querySelector(".input"),t=e.selectionStart,s=e.selectionEnd,i=this.properties.value;i.length+1!==t?this.properties.value=i.slice(0,t)+"\n"+i.slice(s):this.properties.value+=letter,e.value=this.properties.value,e.setSelectionRange(t+1,t+1)}_spaceKeyPress(){let e=document.querySelector(".input"),t=e.selectionStart,s=e.selectionEnd,i=this.properties.value;i.length+1!==t?this.properties.value=i.slice(0,t)+" "+i.slice(s):this.properties.value+=letter,e.value=this.properties.value,e.setSelectionRange(t+1,t+1)}_tabKeyPress(){let e=document.querySelector(".input"),t=e.selectionStart,s=e.selectionEnd,i=this.properties.value;i.length+1!==t?this.properties.value=i.slice(0,t)+"    "+i.slice(s):this.properties.value+=letter,e.value=this.properties.value,e.setSelectionRange(t+4,t+4)}_altKeyPress(){this.properties.alt=!this.properties.alt}_ctrlKeyPress(){this.properties.ctrl=!this.properties.ctrl}_shift(){if(this.properties.shift=!this.properties.shift,"ru"===this.properties.currentLanguage){for(let e in this.properties.dictRuShiftFirstLine)this.elements.keys[e].textContent===this.properties.dictRu[e]?this.elements.keys[e].textContent=this.properties.dictRuShiftFirstLine[e]:this.elements.keys[e].textContent=this.properties.dictRu[e];this._toggleCaps()}else{for(let e in this.properties.dictEnShiftFirstLine)this.elements.keys[e].textContent===this.properties.dictEn[e]?this.elements.keys[e].textContent=this.properties.dictEnShiftFirstLine[e]:this.elements.keys[e].textContent=this.properties.dictEn[e];this._toggleCaps()}}_input(e){switch(e){case"write":document.querySelector(".input").value=this.properties.value;break;case"read":this.properties.value=document.querySelector(".input").value}}_toggleCaps(){this.properties.capsLock=!this.properties.capsLock,this.elements.keys.forEach((e=>{this.properties.unToggledKeys.includes(e.innerText.toLowerCase())||(e.textContent=this.properties.capsLock?e.innerText.toUpperCase():e.innerText.toLowerCase())}))}_keyPress(){document.querySelector(".input").addEventListener("keydown",(e=>{e.preventDefault();let t=document.querySelectorAll(".key"),s="ru"===this.properties.currentLanguage?this.properties.whichKeyRU:this.properties.whichKeyEN;t.forEach((t=>{if(this.properties.codeKey[e.code]===t.textContent)switch(console.log(e.code),t.textContent){case"Space":this._spaceKeyPress(),t.classList.add("active");break;case"Backspace":this._backspaceKeyPress(),t.classList.add("active");break;case"Enter":this._enterKeyPress(),t.classList.add("active");break;case"Shift":"ShiftLeft"===e.code?document.querySelector(".shiftleft").classList.add("active"):document.querySelector(".shiftright").classList.add("active"),this.properties.shiftReal||(this.properties.shiftReal=!0,this._shift());break;case"CapsLock":this._toggleCaps(),t.classList.toggle("caps-active"),t.classList.add("active");break;case"Tab":this._tabKeyPress(),t.classList.add("active");break;case"Ctrl":"ControlLeft"===e.code?document.querySelector(".ctrlleft").classList.add("active"):document.querySelector(".ctrlright").classList.add("active"),this._ctrlKeyPress();break;case"Win":t.classList.add("active");break;case"Alt":"AltLeft"===e.code?document.querySelector(".altleft").classList.add("active"):document.querySelector(".altright").classList.add("active"),this._altKeyPress();break;case"Del":this._delKeyPress(),t.classList.add("active")}else t.textContent.toLowerCase()===s[e.which]&&(this._defaultKeyPress(e),t.classList.add("active"))}))})),document.querySelector(".input").addEventListener("keyup",(e=>{let t=document.querySelectorAll(".key"),s="ru"===this.properties.currentLanguage?this.properties.whichKeyRU:this.properties.whichKeyEN;t.forEach((t=>{this.properties.codeKey[e.code]===t.textContent?(t.classList.remove("active"),this.properties.shift&&(this._shift(),this.properties.shiftReal=!1)):t.textContent.toLowerCase()===s[e.which]&&t.classList.remove("active")}))}))}_changeLanguage(){if("ru"===this.properties.currentLanguage){for(let e=0;e<this.elements.keys.length;e++){let t=this.elements.keys[e].textContent;"Shift"!==t&&"Alt"!==t&&"Ctrl"!==t&&(this.elements.keys[e].textContent=this.properties.dictEn[e])}this.properties.currentLanguage="en"}else{for(let e=0;e<this.elements.keys.length;e++){let t=this.elements.keys[e].textContent;"Shift"!==t&&"Alt"!==t&&"Ctrl"!==t&&(this.elements.keys[e].textContent=this.properties.dictRu[e])}this.properties.currentLanguage="ru"}}};window.addEventListener("DOMContentLoaded",(()=>{e.init()}))})();